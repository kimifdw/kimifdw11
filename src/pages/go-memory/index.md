---
title: golang内存管理
date: "2021-02-18"
spoiler: go 内存管理
---
# 策略
1. MADV_FREE
> 内核会在进程的页表中将这些页标记为“未分配”，从而进程的 RSS 就会变小。OS 后续可以将对应的物理页分配给其他进程。

2. MADV_DONTNEED
> 内核只会在页表中将这些进程页面标记为可回收，在需要的时候才回收这些页面

# 应用版本
1. Go1.12之前，使用**MADV_DONTNEED**策略
2. Go1.12-1.15，使用**MADV_FREE**策略【linux内核版本>=4.5】

# MADV_FREE带来的问题
1. 引发用户体验的问题
2. 混淆统计信息和监控工具的情况
3. 导致与内存使用有关联的个别管理系统集成不良
4. 挤压同主机上的其他应用资源